<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Buscador de Arbitraje Cripto</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        input, button { margin: 10px; padding: 8px; }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Buscador de Cripto Más Barata y Plataforma Más Cara</h1>
    <label for="crypto">Criptomoneda (ej. bitcoin, ethereum):</label>
    <input type="text" id="crypto" value="bitcoin">
    <br>
    <label for="gasFee">Costo de Gas (USDT):</label>
    <input type="number" id="gasFee" value="1.3" step="0.01">
    <br>
    <button onclick="searchArbitrage()">Buscar</button>
    <div id="results"></div>

    <script>
        const API_KEY = 'CG-uqD4sh66T7FrvQY9uCf5EF9o'; // Obtén una clave gratuita en coingecko.com

        async function searchArbitrage() {
            const crypto = document.getElementById('crypto').value.toLowerCase();
            const gasFee = parseFloat(document.getElementById('gasFee').value);
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = 'Cargando...';

            try {
                // Consulta precios agregados de CoinGecko
                const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${crypto}&vs_currencies=usd&include_market_data=true&x_cg_demo_api_key=${API_KEY}`);
                const data = await response.json();
                if (!data[crypto]) {
                    resultsDiv.innerHTML = 'Criptomoneda no encontrada.';
                    return;
                }

                const usdPrice = data[crypto].usd;
                const usdtPrice = usdPrice; // Asumiendo paridad USDT/USD para simplicidad

                // Simula plataformas (en producción, usa APIs reales como Binance API)
                const platforms = [
                    { name: 'Binance', price: usdtPrice * (1 - 0.005) }, // Simula descuento
                    { name: 'Coinbase', price: usdtPrice * (1 + 0.01) },  // Simula aumento
                    { name: 'Kraken', price: usdtPrice * (1 - 0.002) }
                ];

                // Encuentra la más barata y la más cara
                const cheapest = platforms.reduce((min, p) => p.price < min.price ? p : min);
                const mostExpensive = platforms.reduce((max, p) => p.price > max.price ? p : max);

                // Calcula diferencia y verifica contra gas
                const difference = mostExpensive.price - cheapest.price;
                const profitable = difference > gasFee;

                resultsDiv.innerHTML = `
                    <h2>Resultados para ${crypto.toUpperCase()}</h2>
                    <p>Precio promedio: ${usdtPrice.toFixed(6)} USDT</p>
                    <p>Plataforma más barata: ${cheapest.name} - ${cheapest.price.toFixed(6)} USDT</p>
                    <p>Plataforma más cara: ${mostExpensive.name} - ${mostExpensive.price.toFixed(6)} USDT</p>
                    <p>Diferencia: ${difference.toFixed(6)} USDT</p>
                    <p>¿Rentable después de gas (${gasFee} USDT)? ${profitable ? 'Sí' : 'No'}</p>
                `;
            } catch (error) {
                resultsDiv.innerHTML = 'Error al consultar datos: ' + error.message;
            }
        }
    </script>
</body>
  </html>
